import{a as S}from"./chunk-WLX6DBK5.js";import{a as b}from"./chunk-36LNNEJR.js";import{b as c}from"./chunk-CRCKSX74.js";import"./chunk-GI7LLYGM.js";import{a as x}from"./chunk-DT2WSX4O.js";import"./chunk-DGI52A4N.js";import"./chunk-URWAKGWD.js";import{a as t}from"./chunk-MEABNXAK.js";import{a as f,b as o,c as h}from"./chunk-NGSZJRVL.js";import"./chunk-V66ALGLP.js";function k(){return typeof globalThis.location>"u"?"":new URLSearchParams(globalThis.location.search).get("q")||""}function T(){let i=k(),u=c(i),e=c(null),l=c(""),[n,E]=f(i),p=h(null),[v,d]=f(null),g=n==="";o(()=>{async function s(){try{let a=await fetch("/example-users.json");if(!a.ok)throw new Error("Failed to fetch example users");let r=await a.json();if(r.length>0){let m=Math.floor(Math.random()*r.length);d(r[m])}else d("Tumbles")}catch(a){console.error("Error loading example users:",a),d("Tumbles")}}s()},[]),o(()=>{let s=setTimeout(()=>E(u.value),200);return()=>clearTimeout(s)},[u.value]),o(()=>{if(n){D(n);let s=new URL(globalThis.location.href);s.searchParams.set("q",n),globalThis.history.replaceState(null,"",s.toString())}else{y();let s=new URL(globalThis.location.href);s.searchParams.delete("q"),globalThis.history.replaceState(null,"",s.toString())}},[n]);function y(){e.value=null,l.value=""}async function D(s){l.value="";try{let a=await fetch(`/api/v0/credit-score?username=${s}`),r=await a.json();if(a.ok)r.userExists?(e.value={username:r.username,creditScore:r.creditScore,riskBaseFee:r.riskBaseFee,avatarUrl:r.avatarUrl,userExists:!0,fetchSuccess:!0,userDeleted:r.userDeleted},l.value=""):(e.value={username:s,creditScore:0,riskBaseFee:0,avatarUrl:null,userExists:!1,fetchSuccess:!0,userDeleted:r.userDeleted},r.userDeleted?l.value="":l.value=`User @${s} not found.`);else{let m=(typeof r=="object"&&r!==null&&"error"in r&&typeof r.error=="string"?r.error:a.statusText)||"Unknown error";l.value=`Error fetching data: ${m}`,e.value={username:s,creditScore:0,riskBaseFee:0,avatarUrl:null,userExists:!1,fetchSuccess:!1,userDeleted:r.userDeleted}}}catch(a){console.error("Fetch error:",a),l.value=`An unexpected network error occurred: ${typeof a=="object"&&a!==null&&"message"in a?a.message:String(a)}`,e.value={username:n,creditScore:0,riskBaseFee:0,avatarUrl:null,userExists:!1,fetchSuccess:!1,userDeleted:!1}}}o(()=>{p.current?.focus()},[]);let U=!!n&&!e.value&&!l.value,w=v?`Ex. ${v}`:"";return t("div",{class:"w-full max-w-md mx-auto pt-6 pb-6 px-0 sm:px-6",children:[t(x,{username:n,creditScore:e.value?.creditScore||0,riskBaseFee:e.value?.riskBaseFee||0,avatarUrl:e.value?.avatarUrl||null,isWaiting:U,userExists:e.value?.userExists,fetchSuccess:e.value?.fetchSuccess,isEmptyInput:g,userDeleted:e.value?.userDeleted}),t("div",{class:"mt-4 relative group",children:[t("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none text-gray-400 group-focus-within:text-blue-400 transition-colors duration-200",children:"@"}),t("input",{ref:p,type:"text",placeholder:w,value:u.value,onInput:s=>u.value=s.target.value,class:"w-full pl-8 p-3 bg-gray-900 text-white border border-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t("div",{class:"text-center pt-4",children:g?t("p",{class:"text-gray-500",children:"Enter a username to see the score."}):l.value?t("p",{class:"text-red-400",children:l.value}):e.value?.userExists&&!e.value?.userDeleted?t("div",{class:"flex flex-wrap justify-center items-center gap-2 text-xs text-green-400",children:[t("span",{children:"\u2705"}),t("a",{href:`https://manifold.markets/${e.value?.username}`,target:"_blank",class:"text-blue-400 hover:underline",children:["Visit ",e.value.username,"'s Manifold page"]}),t("div",{class:"flex items-center gap-2 ml-auto",children:[t(S,{username:e.value.username}),t(b,{username:e.value.username})]})]}):e.value?.userDeleted?t("p",{class:"text-yellow-400",children:["User @",n," is deleted."]}):null})]})}export{T as default};
