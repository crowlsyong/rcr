import{a as R}from"./chunk-3CDSNM2E.js";import{a as N}from"./chunk-BGAGR5EP.js";import{a as K}from"./chunk-UEW6GMLF.js";import"./chunk-FY5XLUFK.js";import"./chunk-MDKWYR7H.js";import"./chunk-VJKCRGMR.js";import"./chunk-UDB5F2VA.js";import"./chunk-7UDLBCHB.js";import"./chunk-KJUIZF3L.js";import"./chunk-VDHCVOLT.js";import"./chunk-LXVAW3J2.js";import"./chunk-2KIHA6BK.js";import"./chunk-EPD7645U.js";import{a as T}from"./chunk-ANFNCJJN.js";import{a as U}from"./chunk-FN46GB3D.js";import"./chunk-EJWRTPIH.js";import"./chunk-PZAS25NI.js";import{a as D}from"./chunk-TBPJSOHY.js";import"./chunk-VF3G6GHT.js";import{a as L}from"./chunk-FXIQ5MN4.js";import{b as B}from"./chunk-YW3YQVQS.js";import{b as O}from"./chunk-CRCKSX74.js";import"./chunk-GI7LLYGM.js";import"./chunk-HNGXSQHJ.js";import"./chunk-URWAKGWD.js";import{a as t}from"./chunk-MEABNXAK.js";import{a,b as g}from"./chunk-NGSZJRVL.js";import"./chunk-V66ALGLP.js";function z(){let[c,q]=a(""),[m,F]=a(""),[r,h]=a(null),[o,p]=a(null),[V,w]=a(!1),[Y,v]=a(null),[u,$]=a(1e3),[A]=a(1),[x]=a(99),[P]=a(!0),[k]=a(1),[H]=a(!0),[b,_]=a(null),[s,I]=a(null),[M,i]=a(null),[C,f]=a(null),y=O(50),E=()=>{if(r){if(r.outcomeType==="BINARY"&&typeof r.probability=="number")return r.probability*100;if(r.outcomeType==="MULTIPLE_CHOICE"&&o){let e=r.answers?.find(n=>n.id===o);return e?e.probability*100:void 0}}};g(()=>{let e=E();typeof e=="number"&&(y.value=Math.round(e))},[r,o]),g(()=>{let e=setTimeout(async()=>{let n=c.split("/").pop()?.trim();if(!n){h(null),v(null),p(null),I(null),i(null),f(null);return}w(!0),v(null);try{let{data:l,error:S}=await B(n);if(S)throw new Error(S);r?.id!==l?.id&&p(null),h(l)}catch(l){v(`Failed to fetch market: ${typeof l=="object"&&l!==null&&"message"in l?l.message:String(l)}`),h(null),p(null)}finally{w(!1)}},500);return()=>clearTimeout(e)},[c]),g(()=>{if(i(null),f(null),I(null),!m){i("Enter your Manifold API Key to enable betting.");return}if(!r){i("Please enter a valid Manifold market URL.");return}if(r.outcomeType==="MULTIPLE_CHOICE"&&!o){i("Please select an answer for this multiple choice market.");return}if(u<=0){i("Please enter a total bet amount greater than zero.");return}let e=U({marketUrlInput:c,lowerProbabilityInput:A,upperProbabilityInput:x,totalBetAmountInput:u,isVolatilityBet:P,granularityInput:k});if(e){f(`Validation Error: ${e}`);return}if(H&&(!b||b.length===0)){i("Adjust chart controls to generate bet distribution points.");return}let{orders:n,totalShares:l}=L({lowerProbability:A/100,upperProbability:x/100,totalBetAmount:u,isVolatilityBet:P,granularity:k,advancedPoints:b,currentProbabilityForAdvanced:y.value});if(!n||n.length===0){f("Could not calculate any valid orders for the given parameters. Adjust bet amount or distribution on the chart.");return}I({orders:n,totalSharesAcquired:l,error:null,contractId:r.id,answerId:o})},[c,m,r,o,u,b,y.value]);let j=s&&!s.error&&s.orders&&s.orders.length>0,d=e=>Number.isInteger(e)?e.toString():e.toFixed(2);return t("div",{class:"p-4 mx-auto w-full sm:max-w-screen-lg text-gray-100",children:[t("h1",{class:"text-2xl font-bold mb-4",children:"\u{1F99D} Advanced Limits App"}),t("p",{class:"mb-6 text-gray-300",children:"Visualize and fine-tune your limit order distributions across a market's probability range. Design custom bet strategies with granular control."}),t("div",{class:"bg-black shadow sm:rounded-lg p-6 mb-6 border border-gray-700 space-y-6",children:t("div",{class:"flex flex-col sm:flex-row sm:space-x-4 space-y-6 sm:space-y-0",children:[t("div",{class:"sm:flex-1",children:t(R,{marketUrlInput:c,setMarketUrlInput:q,loading:V,fetchError:Y,marketData:r})}),t("div",{class:"sm:flex-1",children:t(N,{apiKey:m,setApiKey:F})})]})}),C&&t("p",{class:"text-red-400 mb-4",children:["Error: ",C]}),r&&r.outcomeType==="MULTIPLE_CHOICE"&&r.answers&&t(D,{answers:r.answers,selectedAnswerId:o,onAnswerSelect:p}),t("div",{class:"mb-6 bg-black",children:t(K,{totalBetAmount:u,lowerProbability:A,upperProbability:x,onDistributionChange:_,onBetAmountChange:$,marketProbability:E(),currentProbability:y,marketData:r,selectedAnswerId:o})}),M&&t("p",{class:"text-gray-400 mb-4 text-center",children:M}),r&&m&&j?t("div",{class:"bg-gray-900 shadow sm:rounded-lg p-6 mb-6 border border-gray-700 mt-6",children:[t("h2",{class:"text-xl font-semibold mb-3 text-white",children:"Calculated Limit Orders (Advanced)"}),t("p",{class:"mb-6",children:["With a total budget of M",t("span",{class:"font-bold text-white",children:d(u)}),", you will acquire a total of approximately"," ",t("span",{class:"font-bold text-white",children:[d(s.totalSharesAcquired)," shares"]})," ","across all orders."]}),t("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4 text-xxs",children:[t("div",{class:"space-y-2",children:[t("h3",{class:"font-semibold text-green-400 mb-2",children:"YES Bets"}),t("ul",{class:"space-y-2",children:[s.orders.filter(e=>e.yesAmount>0).map((e,n)=>t("li",{class:"p-2 bg-gray-900 rounded-md border border-gray-700",children:[t("div",{class:"font-semibold text-gray-300 mb-1",children:["Order (Acquires ~",d(e.shares)," shares)"]}),t("span",{children:["Bet ",t("span",{class:"font-bold text-green-400",children:"YES"})," ","at ",Math.round(e.yesProb*100),"%:"," ",t("span",{class:"font-bold text-white",children:["M",d(e.yesAmount)]})]})]},`yes-${n}`)),s.orders.filter(e=>e.yesAmount>0).length===0&&t("p",{class:"text-gray-500",children:"No YES bets calculated."})]})]}),t("div",{class:"space-y-2",children:[t("h3",{class:"font-semibold text-red-400 mb-2",children:"NO Bets"}),t("ul",{class:"space-y-2",children:[s.orders.filter(e=>e.noAmount>0).sort((e,n)=>n.noProb-e.noProb).map((e,n)=>t("li",{class:"p-2 bg-gray-900 rounded-md border border-gray-700",children:[t("div",{class:"font-semibold text-gray-300 mb-1",children:["Order (Acquires ~",d(e.shares)," shares)"]}),t("span",{children:["Bet ",t("span",{class:"font-bold text-red-400",children:"NO"})," at"," ",Math.round(e.noProb*100),"%:"," ",t("span",{class:"font-bold text-white",children:["M",d(e.noAmount)]})]})]},`no-${n}`)),s.orders.filter(e=>e.noAmount>0).length===0&&t("p",{class:"text-gray-500",children:"No NO bets calculated."})]})]})]}),t(T,{orders:s.orders,apiKey:m,contractId:s.contractId,answerId:s.answerId,marketUrl:r.url})]}):null]})}export{z as default};
